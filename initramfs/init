#!/bin/sh

echo "NextOS initramfs starting..."

# Create essential directories
mkdir -p /proc /sys /dev /etc /root /tmp /var/run

# Mount essential filesystems (may already be mounted by kernel)
[ -e /proc/version ] || mount -t proc proc /proc 2>/dev/null
[ -e /sys/kernel ] || mount -t sysfs sysfs /sys 2>/dev/null
[ -e /dev/null ] || mount -t devtmpfs devtmpfs /dev 2>/dev/null || mount -t tmpfs tmpfs /dev 2>/dev/null

echo ""
echo "========================================="
echo "NextOS Initramfs - Ready for interaction"
echo "========================================="
echo ""
echo "Filesystem mounted:"
mount | grep -E "proc|sys|dev|root"
echo ""
echo "Available commands:"
ls /bin | head -10
echo ""
echo "Type 'ls /' to explore, 'exit' to shutdown"
echo ""

# Try to find a shell
if [ -x /bin/sh ]; then
    exec /bin/sh
else
    echo "ERROR: No shell found!"
    panic
fi
